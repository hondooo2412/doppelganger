/* ============================================================
   Doppelganger 共通スタイル
   診断ページと同じダークUIテーマを踏襲
   ============================================================ */

/* --- リセット & CSS変数 --- */
*{margin:0;padding:0;box-sizing:border-box}
:root{
  --bg:#0a0a0f;
  --surface:#12121e;
  --surface2:#1a1a2e;
  --surface3:#242440;
  --accent:#6c5ce7;
  --accent2:#a29bfe;
  --pink:#e84393;
  --text:#e8e8ef;
  --text2:#7a7a9e;
  --success:#00b894;
  --warning:#fdcb6e;
  --danger:#e17055;
  --radius:14px;
  --shadow:0 8px 32px rgba(0,0,0,.5);
  /* ファミリーカラー */
  --fam-architects:108,92,231;
  --fam-mystics:232,67,147;
  --fam-commanders:0,184,148;
  --fam-catalysts:253,203,110;
}
html,body{
  height:100%;
  font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',system-ui,sans-serif;
  background:var(--bg);
  color:var(--text);
  overflow-x:hidden;
  -webkit-tap-highlight-color:transparent;
  -webkit-text-size-adjust:100%;
  touch-action:manipulation;
}
a{color:var(--accent2);text-decoration:none;transition:color .2s}
a:hover{color:var(--accent)}

/* --- アニメーション --- */
@keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
@keyframes fadeOut{from{opacity:1}to{opacity:0}}
@keyframes slideIn{from{opacity:0;transform:translateX(30px)}to{opacity:1;transform:translateX(0)}}
@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}
@keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-6px)}}

/* --- レイアウト --- */
.page{
  min-height:100vh;min-height:100dvh;
  padding:20px;
  padding-top:env(safe-area-inset-top,20px);
  padding-bottom:env(safe-area-inset-bottom,20px);
  animation:fadeIn .5s ease;
}
.container{
  width:100%;
  max-width:640px;
  margin:0 auto;
}

/* --- ナビゲーションバー --- */
.nav-bar{
  position:fixed;bottom:0;left:0;right:0;
  background:var(--surface);
  border-top:1px solid var(--surface3);
  display:flex;
  padding:8px 0;
  padding-bottom:calc(8px + env(safe-area-inset-bottom,0px));
  z-index:100;
}
.nav-item{
  flex:1;
  display:flex;flex-direction:column;align-items:center;gap:2px;
  padding:6px 0;
  color:var(--text2);
  font-size:.65rem;
  text-decoration:none;
  transition:color .2s;
  cursor:pointer;
  border:none;background:none;
}
.nav-item:hover,.nav-item.active{color:var(--accent2)}
.nav-icon{font-size:1.3rem;line-height:1}

/* ナビバー分のpadding */
.page{padding-bottom:calc(80px + env(safe-area-inset-bottom,0px))}

/* --- ヘッダー --- */
.page-header{
  display:flex;align-items:center;gap:12px;
  margin-bottom:20px;
}
.page-header .back-btn{
  width:36px;height:36px;
  border:1px solid var(--surface3);border-radius:50%;
  background:var(--surface);color:var(--text2);
  display:flex;align-items:center;justify-content:center;
  cursor:pointer;font-size:1rem;transition:all .2s;
  flex-shrink:0;
}
.page-header .back-btn:hover{border-color:var(--accent);color:var(--text)}
.page-title{font-size:1.15rem;font-weight:700}
.page-subtitle{font-size:.8rem;color:var(--text2);margin-top:2px}

/* --- カード --- */
.card{
  background:var(--surface);
  border:1px solid var(--surface3);
  border-radius:var(--radius);
  padding:20px;
  margin-bottom:12px;
  transition:border-color .2s;
}
.card:hover{border-color:rgba(108,92,231,.3)}
.card-clickable{cursor:pointer}

/* --- ボタン --- */
.btn{
  display:inline-flex;align-items:center;justify-content:center;gap:6px;
  padding:12px 28px;
  font-size:.9rem;font-weight:600;
  border:none;border-radius:50px;
  cursor:pointer;
  transition:all .3s;
  -webkit-appearance:none;
  touch-action:manipulation;
}
.btn-primary{
  background:linear-gradient(135deg,var(--accent),var(--accent2));
  color:#fff;
  box-shadow:0 4px 20px rgba(108,92,231,.3);
}
.btn-primary:hover{transform:translateY(-2px);box-shadow:0 6px 24px rgba(108,92,231,.5)}
.btn-primary:active{transform:translateY(0)}
.btn-primary:disabled{opacity:.4;cursor:not-allowed;transform:none}

.btn-secondary{
  background:transparent;
  border:1px solid var(--surface3);
  color:var(--text2);
}
.btn-secondary:hover{border-color:var(--accent);color:var(--text)}

.btn-danger{
  background:transparent;
  border:1px solid rgba(225,112,85,.3);
  color:var(--danger);
}
.btn-danger:hover{background:rgba(225,112,85,.1);border-color:var(--danger)}

.btn-sm{padding:8px 18px;font-size:.8rem}
.btn-block{width:100%;display:flex}

/* --- 入力フォーム --- */
.form-group{margin-bottom:16px}
.form-label{
  display:block;
  font-size:.78rem;font-weight:600;
  color:var(--text2);
  margin-bottom:6px;
  letter-spacing:.04em;
}
.form-input{
  width:100%;
  padding:14px 16px;
  background:var(--surface2);
  border:1px solid var(--surface3);
  border-radius:10px;
  color:var(--text);
  font-size:.9rem;
  transition:border-color .2s;
  outline:none;
  -webkit-appearance:none;
}
.form-input:focus{border-color:var(--accent)}
.form-input::placeholder{color:var(--text2);opacity:.6}
textarea.form-input{
  resize:vertical;
  min-height:100px;
  line-height:1.6;
  font-family:inherit;
}
.form-hint{font-size:.7rem;color:var(--text2);margin-top:4px}
.form-error{font-size:.75rem;color:var(--danger);margin-top:4px;display:none}
.form-error.show{display:block}

/* --- バッジ --- */
.badge{
  display:inline-flex;align-items:center;gap:4px;
  padding:4px 10px;
  border-radius:20px;
  font-size:.7rem;font-weight:600;
  border:1px solid;
}
.badge-architects{
  color:rgb(var(--fam-architects));
  border-color:rgba(var(--fam-architects),.3);
  background:rgba(var(--fam-architects),.08);
}
.badge-mystics{
  color:rgb(var(--fam-mystics));
  border-color:rgba(var(--fam-mystics),.3);
  background:rgba(var(--fam-mystics),.08);
}
.badge-commanders{
  color:rgb(var(--fam-commanders));
  border-color:rgba(var(--fam-commanders),.3);
  background:rgba(var(--fam-commanders),.08);
}
.badge-catalysts{
  color:rgb(var(--fam-catalysts));
  border-color:rgba(var(--fam-catalysts),.3);
  background:rgba(var(--fam-catalysts),.08);
}

/* --- タイプバッジ（投稿者表示用） --- */
.user-badge{
  display:flex;align-items:center;gap:8px;
}
.user-type-icon{
  width:32px;height:32px;
  border-radius:50%;
  display:flex;align-items:center;justify-content:center;
  font-size:.9rem;
  flex-shrink:0;
}
.user-info{display:flex;flex-direction:column;gap:1px}
.user-type-name{font-size:.78rem;font-weight:600;color:var(--text)}
.user-display-id{font-size:.68rem;color:var(--text2)}

/* --- 投稿カード --- */
.post-card{
  background:var(--surface);
  border:1px solid var(--surface3);
  border-radius:var(--radius);
  padding:16px;
  margin-bottom:10px;
  animation:fadeIn .3s ease;
}
.post-header{
  display:flex;align-items:center;justify-content:space-between;
  margin-bottom:10px;
}
.post-content{
  font-size:.88rem;
  line-height:1.75;
  color:var(--text);
  margin-bottom:12px;
  word-break:break-word;
}
.post-actions{
  display:flex;align-items:center;gap:16px;
  font-size:.75rem;color:var(--text2);
}
.post-action{
  display:flex;align-items:center;gap:4px;
  cursor:pointer;
  border:none;background:none;color:var(--text2);
  padding:4px 0;
  transition:color .2s;
}
.post-action:hover{color:var(--accent2)}
.post-action.liked{color:var(--pink)}
.post-time{font-size:.7rem;color:var(--text2);margin-left:auto}

/* --- スレッド一覧 --- */
.thread-item{
  display:flex;align-items:flex-start;gap:12px;
  padding:14px 16px;
  background:var(--surface);
  border:1px solid var(--surface3);
  border-radius:var(--radius);
  margin-bottom:8px;
  cursor:pointer;
  transition:border-color .2s;
  text-decoration:none;
  color:var(--text);
}
.thread-item:hover{border-color:rgba(108,92,231,.3)}
.thread-icon{font-size:1.2rem;margin-top:2px;flex-shrink:0}
.thread-body{flex:1;min-width:0}
.thread-title{font-size:.9rem;font-weight:600;margin-bottom:4px;line-height:1.4}
.thread-meta{font-size:.72rem;color:var(--text2);display:flex;align-items:center;gap:10px}
.thread-pinned{color:var(--warning);font-weight:600}
.thread-locked{color:var(--text2);opacity:.6}

/* --- 板カード（掲示板トップ用） --- */
.board-card{
  display:flex;align-items:center;gap:14px;
  padding:16px 18px;
  background:var(--surface);
  border:1px solid var(--surface3);
  border-radius:var(--radius);
  margin-bottom:10px;
  cursor:pointer;
  transition:all .2s;
  text-decoration:none;color:var(--text);
}
.board-card:hover{border-color:rgba(108,92,231,.3);transform:translateX(4px)}
.board-icon{font-size:1.6rem;flex-shrink:0;width:44px;text-align:center}
.board-info{flex:1;min-width:0}
.board-name{font-size:.92rem;font-weight:700;margin-bottom:3px}
.board-desc{font-size:.75rem;color:var(--text2);line-height:1.4}
.board-arrow{color:var(--text2);font-size:1rem;flex-shrink:0}

/* --- ローディング --- */
.loading{
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  padding:40px 0;
  color:var(--text2);
  gap:12px;
}
.spinner{
  width:32px;height:32px;
  border:3px solid var(--surface3);
  border-top-color:var(--accent);
  border-radius:50%;
  animation:spin .8s linear infinite;
}

/* --- 空状態 --- */
.empty-state{
  text-align:center;
  padding:40px 20px;
  color:var(--text2);
}
.empty-icon{font-size:2.5rem;margin-bottom:12px;opacity:.5}
.empty-text{font-size:.88rem;line-height:1.6}

/* --- モーダル --- */
.modal-overlay{
  position:fixed;top:0;left:0;right:0;bottom:0;
  background:rgba(0,0,0,.7);
  display:none;align-items:center;justify-content:center;
  z-index:200;
  padding:20px;
  animation:fadeIn .2s ease;
}
.modal-overlay.show{display:flex}
.modal{
  background:var(--surface);
  border:1px solid var(--surface3);
  border-radius:var(--radius);
  padding:24px;
  width:100%;max-width:480px;
  max-height:80vh;overflow-y:auto;
  animation:fadeIn .3s ease;
}
.modal-title{font-size:1rem;font-weight:700;margin-bottom:16px}
.modal-actions{display:flex;gap:10px;justify-content:flex-end;margin-top:20px}

/* --- トースト通知 --- */
.toast{
  position:fixed;bottom:100px;left:50%;transform:translateX(-50%);
  background:var(--surface2);
  border:1px solid var(--surface3);
  border-radius:50px;
  padding:10px 24px;
  font-size:.82rem;
  color:var(--text);
  box-shadow:var(--shadow);
  z-index:300;
  animation:fadeIn .3s ease;
  pointer-events:none;
}
.toast.success{border-color:rgba(0,184,148,.4);color:var(--success)}
.toast.error{border-color:rgba(225,112,85,.4);color:var(--danger)}

/* --- セクション見出し --- */
.section-title{
  font-size:.78rem;
  font-weight:600;
  color:var(--text2);
  letter-spacing:.1em;
  text-transform:uppercase;
  margin-bottom:12px;
  padding-left:4px;
}

/* --- タブ --- */
.tabs{
  display:flex;gap:4px;
  background:var(--surface);
  border-radius:10px;
  padding:4px;
  margin-bottom:16px;
  border:1px solid var(--surface3);
}
.tab{
  flex:1;
  padding:8px 12px;
  text-align:center;
  font-size:.8rem;font-weight:600;
  color:var(--text2);
  border:none;background:none;
  border-radius:8px;
  cursor:pointer;
  transition:all .2s;
}
.tab.active{background:var(--accent);color:#fff}
.tab:hover:not(.active){color:var(--text)}

/* --- 区切り線 --- */
.divider{
  height:1px;
  background:var(--surface3);
  margin:16px 0;
}

/* --- ユーティリティ --- */
.hidden{display:none!important}
.text-center{text-align:center}
.text-muted{color:var(--text2)}
.text-sm{font-size:.8rem}
.text-xs{font-size:.7rem}
.mt-8{margin-top:8px}
.mt-16{margin-top:16px}
.mt-24{margin-top:24px}
.mb-8{margin-bottom:8px}
.mb-16{margin-bottom:16px}

/* --- レスポンシブ --- */
@media(max-width:420px){
  .page{padding:14px}
  .card{padding:14px}
  .post-card{padding:12px}
  .board-card{padding:12px 14px}
}
